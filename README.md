# The MiniZinc Discord Bot

This repository contains the MiniZinc discord bot.
When prompted with a MiniZinc instance, this bot will run the instance, and will reply with the result.

## Usage

In its most basic form, the bot will look for messages in the form `!mzn <code>`, where `<code>` is replaced by your MiniZinc instance. For example, when prompted with the message

> !mzn \`\`\`
>
> include "all_different.mzn";
>
> array[1..3] of var 1..3: x;
>
> constraint all_different(x);
>
> output ["\\([x[i] + 1 | i in 1..3])"]
>
> \`\`\`

the bot will respond with (something like)

> `SATISFIED` in 0.1s
>
> ```[2,3,4]```

Note that the message can contain backticks (i.e., \`\`\`) in the message to the bot, that are ignored.
This ensures that the code in the message is formatted nicely.

### Options

By default, the MiniZinc Discord bot will use the Chuffed solver. 
This can be changed to any of the other standard MiniZinc solvers using the `solver=<name>` option.
The MiniZinc image by default includes `gecode`, `chuffed`, and `cbc`.

If you want to change the time limit that is given to the solver, then you can similarly use the `timeout=<seconds>` option.
Note that the time limit can never exceed 30 seconds.

For example, the following instance is run using the Gecode solver:

> !mzn solver=gecode timeout=4 \`\`\`
>
> include "gecode.mzn";
>
> array[1..5] of var 1..100: x;
>
> solve ::relax_and_reconstruct(x, 20) maximize sum(x);
>
> \`\`\`

### Flattening

To show a bug, it can be interesting to have a look at the FlatZinc generated by the MiniZinc compiler.
The MiniZinc bot also answers to the `!flatten` command, and replies with the FlatZinc that the compiler would generate.
The command works very similar to the `!mzn` command, and uses the same options.

The following message is an example of a correct `!flatten` command.

> !flatten \`\`\`
>
> include "all_different.mzn";
>
> array[1..3] of var 1..3: x;
>
> constraint all_different(x);
>
> output ["\\([x[i] + 1 | i in 1..3])"]
>
> \`\`\`

Note that the `!flatten` command will not select a solver by default and will use the standard library to compile the problem.
For example, this means that you will have to add the `solver=chuffed` option for the FlatZinc to match the run instance of the `!mzn` command without any additional options.